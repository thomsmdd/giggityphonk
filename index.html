<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Flappy Bird</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #70c5ce;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }
    canvas {
        background: #70c5ce;
        border: 2px solid #000;
    }
</style>
</head>
<body>

<canvas id="game" width="400" height="600"></canvas>

<script>
// ======================
// VARIÁVEIS DO JOGO
// ======================
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let frames = 0;
const gravity = 0.25;
let gameRunning = true;

// ======================
// PÁSSARO
// ======================
const bird = {
    x: 50,
    y: 150,
    w: 30,
    h: 30,
    speed: 0,

    update() {
        this.speed += gravity;
        this.y += this.speed;
        if (this.y + this.h > canvas.height) gameOver();
    },

    draw() {
        ctx.fillStyle = "yellow";
        ctx.fillRect(this.x, this.y, this.w, this.h);
    },

    flap() {
        this.speed = -5;
    }
};

// ======================
// CANOS
// ======================
const pipes = [];
function spawnPipe() {
    const gap = 130;
    const topHeight = Math.random() * (canvas.height - gap - 100) + 20;

    pipes.push({
        x: canvas.width,
        top: topHeight,
        bottom: topHeight + gap
    });
}

function updatePipes() {
    for (let i = 0; i < pipes.length; i++) {
        let p = pipes[i];
        p.x -= 2;

        // colisão
        if (
            bird.x < p.x + 50 &&
            bird.x + bird.w > p.x &&
            (bird.y < p.top || bird.y + bird.h > p.bottom)
        ) {
            gameOver();
        }

        // remove canos fora da tela
        if (p.x + 50 < 0) pipes.splice(i, 1);
    }

    if (frames % 120 === 0) spawnPipe();
}

function drawPipes() {
    ctx.fillStyle = "green";
    pipes.forEach(p => {
        ctx.fillRect(p.x, 0, 50, p.top);
        ctx.fillRect(p.x, p.bottom, 50, canvas.height - p.bottom);
    });
}

// ======================
// GAME OVER
// ======================
function gameOver() {
    gameRunning = false;
    ctx.font = "40px Arial";
    ctx.fillStyle = "red";
    ctx.fillText("MACACO", 90, canvas.height / 2);
}

// ======================
// LOOP DO JOGO
// ======================
function loop() {
    if (!gameRunning) return;

    frames++;
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    bird.update();
    bird.draw();

    updatePipes();
    drawPipes();

    requestAnimationFrame(loop);
}

loop();

// ======================
// CONTROLES
// ======================
document.addEventListener("keydown", () => bird.flap());
document.addEventListener("mousedown", () => bird.flap());

</script>
</body>
</html>
